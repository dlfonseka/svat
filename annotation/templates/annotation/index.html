{% load static %}
<!DOCTYPE html>

<html>
    <head>
        <script src="{% static 'js/videoplayer.js' %}"></script>
        <link href="https://vjs.zencdn.net/7.11.4/video-js.css" rel="stylesheet" />
        <script src="{% static 'js/annotation.js' %}"></script>
    </head>

    <body>
        {% if available_video %}
            <div>
                <video
                    id="my-video"
                    class="video-js"
                    controls
                    preload="auto"
                    autoplay
                    width="640"
                    height="264"
                    data-setup="{}"
                >
                    <source src='{{MEDIA_URL}}{{available_video}}' type="video/mp4" />
                    <!-- <source src="MY_VIDEO.webm" type="video/webm" /> -->
                    <p class="vjs-no-js">
                    To view this video please enable JavaScript, and consider upgrading to a
                    web browser that
                    <a href="https://videojs.com/html5-video-support/" target="_blank"
                        >supports HTML5 video</a
                    >
                    </p>
                </video>
                <script src="https://vjs.zencdn.net/7.11.4/video.min.js"></script>
                <script>
                    var myPlayer = videojs('my-video');
                    myPlayer.currentTime(parseFloat("{{available_video.video_timestamp}}"));
                </script>
            </div>
        {% endif %}
            
        <div>
            {% if video_model_form %}
            {% if error_message %} <p><strong>{{error_message}}</strong></p> {% endif %}
            {% if video_errors %}{{video_errors}} {% endif %}
            <form action="{% url 'annotation:add_video' %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{video_model_form.non_field_errors}}
                <div class="fieldWrapper">
                    {{ video_model_form.video.errors }}
                    <label for="{{ video_model_form.video.id_for_label }}">Video:</label>
                    {{ video_model_form.video }}
                </div>
                <div class="fieldWrapper">
                    {{ video_model_form.video_timestamp.errors }}
                    <input type="hidden" name="video_timestamp" id="id_video_timestamp" value=0>
                </div>
                <input type='submit' value='Add Video'/>
            </form>
            {% endif %}
        </div>

        {% if available_video %}
            <div>
                {% if tools_model_form %}
                {% if error_message %} <p><strong>{{error_message}}</strong></p> {% endif %}
                {% if tools_errors %}{{tools_errors}} {% endif %}
                <form action="{% url 'annotation:add_tools' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{tools_model_form.non_field_errors}}
                    <div class="fieldWrapper">
                        {{ tools_model_form.tools_file.errors }}
                        <label for="{{ video_model_form.tools_file.id_for_label }}">Tools CSV File:</label>
                        {{ tools_model_form.tools_file }}
                    </div>
                    <div class="fieldWrapper">
                        {{ tools_model_form.tools_video.errors }}
                        <input type="hidden" name="tools_video" id="id_tools_video" value="1">
                    </div>
                    <input type='submit' value='Add Tools File'/>
                </form>
                {% endif %}
            </div>

            <div>
                {% if annotation_model_form %}
                {% if error_message %} <p><strong>{{error_message}}</strong></p> {% endif %}
                {% if annotation_errors %}{{annotation_errors}} {% endif %}
                <form action="{% url 'annotation:add_annotation' %}", method="post">
                    {% csrf_token %}
                    {{annotation_model_form.non_field_errors}}
                    <div class="fieldWrapper">
                        {{ annotation_model_form.annotation_video.errors }}
                        <input type="hidden" name="annotation_video" id="id_annotation_video" value="1">
                    </div>
                    <div class="fieldWrapper">
                        {{ annotation_model_form.annotation_text.errors }}
                        <label for="{{ annotation_model_form.annotation_text.id_for_label }}">Annotation text:</label>
                        {{ annotation_model_form.annotation_text }}
                    </div>
                    <div class="fieldWrapper">
                        {{ annotation_model_form.annotation_detail.errors }}
                        <label for="{{ annotation_model_form.annotation_detail.id_for_label }}">Annotation detail:</label>
                        {{ annotation_model_form.annotation_detail }}
                    </div>
                    <div class="fieldWrapper">
                        {{ annotation_model_form.annotation_timestamp.errors }}
                        <input type="hidden" name="annotation_timestamp" id="id_annotation_timestamp">
                    </div>
                    <div class="fieldWrapper">
                        {{ annotation_model_form.annotation_tool.errors }}
                        <label for="{{ annotation_model_form.annotation_tool.id_for_label }}">Annotation tool:</label>
                        <select name="annotation_tool" id="id_annotation_tool">
                            <option value="" selected disabled>Select Tool</option>
                            {% for tool in tools %}
                                <option value="{{tool}}">{{tool}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <input type='submit' value='Add Annotation' onclick="timestamp()"/>
                    
                </form>
                {% endif %}
            </div>

            <div>
                {% if annotation_list %}
                <h3> List of Annotations </h3> 
                <ul>
                    {% for annotation in annotation_list %}
                    <li>{{error}}  {{annotation.annotation_tool}} {{annotation.annotation_text}} {{annotation.annotation_detail}} {{annotation.annotation_timestamp}}</li>
                    {% endfor %}
                </ul>
                {% else %}
                    <p>No annotations recorded. </p>
                {% endif %}
            </div>

        {% endif %}


    </body>
</html>